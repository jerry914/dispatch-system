(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76d76273"],{"340d":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("8ba4"),n("a9e3");var c=n("7a23"),r=function(e){return Object(c["N"])("data-v-d8ee171e"),e=e(),Object(c["L"])(),e},l={class:"page-container"},a=r((function(){return Object(c["n"])("div",{class:"page-title"},"心理師班表",-1)})),s=r((function(){return Object(c["n"])("option",{value:""},"請選擇學期標籤",-1)})),b=["value"],u=["innerHTML"],o=Object(c["q"])("可諮商時段"),i={style:{display:"flex"}},j={class:"color-box"},d={key:0,class:"counselor-time-table"};function O(e,t,n,r,O,f){var m=Object(c["T"])("el-table-column"),p=Object(c["T"])("QuestionFilled"),h=Object(c["T"])("el-popover"),v=Object(c["T"])("el-table"),_=Object(c["T"])("el-col"),y=Object(c["T"])("el-row");return Object(c["K"])(),Object(c["m"])("div",l,[a,Object(c["kb"])(Object(c["n"])("select",{class:"labelSelector","onUpdate:modelValue":t[0]||(t[0]=function(e){return O.semester_label=e})},[s,(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(O.labelOption,(function(e){return Object(c["K"])(),Object(c["m"])("option",{key:e.label,value:e.label},Object(c["X"])(e.label),9,b)})),128))],512),[[c["eb"],O.semester_label]]),Object(c["r"])(y,{gutter:20},{default:Object(c["jb"])((function(){return[Object(c["r"])(_,{sm:24,md:12},{default:Object(c["jb"])((function(){return[Object(c["r"])(v,{class:"list-container",data:f.counselors,style:{width:"100%"}},{default:Object(c["jb"])((function(){return[Object(c["r"])(m,{prop:"name",label:"姓名",width:"100"}),Object(c["r"])(m,{prop:"semester_label",label:"學期"}),Object(c["r"])(m,{prop:"available_time",label:"可諮商時段"},{header:Object(c["jb"])((function(){return[Object(c["r"])(h,{placement:"right",title:"",width:200,trigger:"hover","popper-class":"weektimePop"},{reference:Object(c["jb"])((function(){return[Object(c["n"])("span",null,[o,Object(c["r"])(p,{style:{width:"1em",height:"1em",padding:"0 0 0 3px"}})])]})),default:Object(c["jb"])((function(){return[Object(c["n"])("div",{innerHTML:e.getHtmlContent()},null,8,u)]})),_:1})]})),default:Object(c["jb"])((function(e){return[Object(c["n"])("div",null,Object(c["X"])(e.row.available_time),1)]})),_:1}),f.cases.data?(Object(c["K"])(),Object(c["k"])(m,{key:0,prop:"assign_time",label:"目前排班狀況"},{default:Object(c["jb"])((function(e){return[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(f.getCasesByCounselorId(e.row.id),(function(e){return Object(c["K"])(),Object(c["m"])("div",null,Object(c["X"])(e.consultation_day)+Object(c["X"])(e.consultation_time)+"-"+Object(c["X"])(e.name)+" | "+Object(c["X"])(e.crisis_level),1)})),256))]})),_:1})):Object(c["l"])("",!0)]})),_:1},8,["data"])]})),_:1}),Object(c["r"])(_,{sm:24,md:12},{default:Object(c["jb"])((function(){return[Object(c["n"])("div",i,[Object(c["n"])("div",null,"0/"+Object(c["X"])(O.counselorNum),1),Object(c["n"])("div",j,[(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(O.maxNum+1,(function(e){return Object(c["K"])(),Object(c["m"])("div",{class:"color-box-item",style:Object(c["B"])("background-color: rgba(242, 164, 75, "+(e-1)/O.maxNum+");width: "+100/O.maxNum+"%;")},null,4)})),256))]),Object(c["n"])("div",null,Object(c["X"])(O.maxNum)+"/"+Object(c["X"])(O.counselorNum)+" (有排班人數/總人數)",1)]),f.countAvailable().length>1?(Object(c["K"])(),Object(c["m"])("div",d,[Object(c["r"])(y,null,{default:Object(c["jb"])((function(){return[Object(c["r"])(_,{class:"picker-col-lable row-border",span:4}),(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(e.days,(function(e){return Object(c["K"])(),Object(c["k"])(_,{class:"picker-col row-border",span:4},{default:Object(c["jb"])((function(){return[Object(c["q"])(Object(c["X"])(e.label),1)]})),_:2},1024)})),256))]})),_:1}),(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(e.times,(function(t,n){return Object(c["K"])(),Object(c["k"])(y,{class:"picker-row",justify:"space-around",style:Object(c["B"])(Number.isInteger(t.value)?"":"border-top: 2px solid #F2A54B")},{default:Object(c["jb"])((function(){return[Object(c["r"])(_,{class:"picker-col-lable",span:4},{default:Object(c["jb"])((function(){return[Object(c["q"])(Object(c["X"])(t.label),1)]})),_:2},1024),(Object(c["K"])(!0),Object(c["m"])(c["b"],null,Object(c["R"])(e.days,(function(e,t){return Object(c["K"])(),Object(c["k"])(_,{class:"picker-col",span:4,style:Object(c["B"])("background-color: rgba(242, 164, 75, "+f.countAvailable()[t][n]/O.maxNum+")")},null,8,["style"])})),256))]})),_:2},1032,["style"])})),256))])):Object(c["l"])("",!0)]})),_:1})]})),_:1})])}var f=n("c7eb"),m=n("1da1"),p=(n("4de4"),n("d3b7"),n("d81d"),n("cb29"),n("159b"),n("ac1f"),n("1276"),n("4e82"),n("b3e6")),h={mixins:[p["a"]],data:function(){return{counselorNum:-1,maxNum:0,semester_label:"",labelOption:[]}},created:function(){var e=this;return Object(m["a"])(Object(f["a"])().mark((function t(){return Object(f["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("fetchCounselors");case 2:return t.next=4,e.$store.dispatch("fetchAssignCases");case 4:return t.next=6,e.$store.dispatch("fetchSemesterLabel");case 6:e.labelOption=e.$store.state.semester_label.data;case 7:case"end":return t.stop()}}),t)})))()},computed:{counselors:function(){var e=this;return""!==this.semester_label?this.$store.state.counselors.filter((function(t){return t.semester_label===e.semester_label})):this.$store.state.counselors},cases:function(){return this.$store.state.assignCases}},methods:{countAvailable:function(){var e=this;this.counselorNum=this.counselors.length;var t=[this.days.length,this.times.length],n=t[0],c=t[1],r=Array(n).fill().map((function(){return Array(c).fill(0)}));return this.counselors.forEach((function(t){""!=t.available_time&&t.available_time.split(",").forEach((function(t){var n=t.split("");n[0]=parseInt(e.dayRule[n[0]])-1,n[1]=parseInt(e.timeRule[n[1]])-1,r[n[0]][n[1]]?r[n[0]][n[1]]+=1:r[n[0]][n[1]]=1,r[n[0]][n[1]]>e.maxNum&&(e.maxNum=r[n[0]][n[1]])}))})),r},getCasesByCounselorId:function(e){var t=this,n=this.cases.data.filter((function(t){return t.counselor_id==e}));return n.sort((function(e,n){var c=t.dayRule[e.consultation_day],r=t.dayRule[n.consultation_day];return c==r?t.timeRule[e.consultation_time]-t.timeRule[n.consultation_time]:t.dayRule[e.consultation_day]-t.dayRule[n.consultation_day]})),n}}},v=(n("de71"),n("d959")),_=n.n(v);const y=_()(h,[["render",O],["__scopeId","data-v-d8ee171e"]]);t["default"]=y},"4de4":function(e,t,n){"use strict";var c=n("23e7"),r=n("b727").filter,l=n("1dde"),a=l("filter");c({target:"Array",proto:!0,forced:!a},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"78d6":function(e,t,n){},"81d5":function(e,t,n){"use strict";var c=n("7b0b"),r=n("23cb"),l=n("07fa");e.exports=function(e){var t=c(this),n=l(t),a=arguments.length,s=r(a>1?arguments[1]:void 0,n),b=a>2?arguments[2]:void 0,u=void 0===b?n:r(b,n);while(u>s)t[s++]=e;return t}},cb29:function(e,t,n){var c=n("23e7"),r=n("81d5"),l=n("44d2");c({target:"Array",proto:!0},{fill:r}),l("fill")},de71:function(e,t,n){"use strict";n("78d6")}}]);
//# sourceMappingURL=chunk-76d76273.37cce8e3.js.map